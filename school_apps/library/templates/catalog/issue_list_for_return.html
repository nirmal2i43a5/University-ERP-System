{% extends 'admin_templates/base_admin.html' %} {% block title %}Issue Book{% endblock title %} {% block main_content %}

<section class="content">
	<div class="container-fluid">
		<!-- /.card-header -->


		<div class="row">
			<div class="col-12">
				{% include "includes/messages.html" %}

				<div class="card">
					
						<div class="card-header" style="background:#435EBE;">
							<h3 class="card-title  text-white">Issue Details of <strong>( {{member.member.student_user.full_name}}:{{member.library_card_no}} )</strong></h3>
						</div>

					<!-- /.card-header -->
					<div class="card-body table-responsive">

					<a href=" {% url 'library:book_issue' %}" class="btn btn-sm btn-outline float-right text-white " style="background:#435EBE;"  >
						<span> <strong>+ Book Issue  </strong></span>
					</a>



					  

					
						<table
							id="dataTable"
							class="table table-sm table-striped table-bordered table-hover text-nowrap dataTable no-footer"
						>
							<thead>
								<tr>
								  <th></th>
									<th class="serial">ID</th>
									<th>Title</th>
									<th>Issue Quantity</th>
									<th>Issued Date</th>
									<th>Expiry  Date</th>
									<th>Action</th>
								</tr>
							</thead>
							<tbody>
								{% if book_issue %} {% for book_issue in book_issue %}
								<tr>
									<td></td>
									<td class="serial">{{ forloop.counter }}</td>

									<td>{{ book_issue.title }}</td>
									<td>{{ book_issue.quantity }}</td>


									<td>{{ book_issue.issue_date}}</td>
									<td>{{ book_issue.expirydate}}</td>

									<td>

								{% if book_issue.quantity == 0 %}

									<button type = "button" class="btn btn-sm btn-success">
									<strong>Already Returned</strong>
											</button>

								{% else %}
								 <form action = "{% url 'library:book_return' member.pk %}" method = "post">
									  										{% csrf_token %}
										<input  type = "hidden" name="bookissue_id" value = "{{book_issue.pk}}" >
										<input  type = "hidden" name="book_id" value = "{{book_issue.title.isbn}}" >


										<input type = "number"  name="quantity" placeholder = "Quantity to Return" required >
                               			 <button type = "submit"
											class="btn btn-sm btn-success"
											>
											<i class="nav-icon fas fa-long-arrow-alt-left"></i
										>  Return
											</button>
										

                                </form>


								{% endif %}
									 
										
									
										
									</td>
								</tr>
								{% endfor %} {% else %}
								<tr>
									<td>No Book issued</td>
								</tr>
								{% endif %}
							</tbody>
						</table>
					</div>
					<!-- /.card-body -->
				</div>
				<!-- /.card -->
			</div>
		</div>
	</div>
</section>

{% endblock main_content %} 
