{% load static %}
{% load auth_extras %}

<!DOCTYPE html>
<html>

{% block head %}


<head>
  <meta charset="utf-8">
  {% comment %} <meta http-equiv="X-UA-Compatible" content="IE=edge"> {% endcomment %}

  <!-- Tell the browser to be responsive to screen width -->
   <meta name="viewport" content="width=device-width, initial-scale=1"> 

  {% include "includes/adminlte_css.html" %}
  {% include "includes/datatables_css.html" %}
 
  <link
  rel="stylesheet"
  href="{% static 'plugins/select2-bootstrap4-theme/select2-bootstrap4.css' %}"
/>
<link
  rel="stylesheet"
  href="{% static 'plugins/select2/css/select2.css' %}"
/>
  <!------------------- Custom Common Css For all ------------->

<link href="{% static 'main_dashboard/css/loader.css' %}" rel="stylesheet">
<link href="{% static 'main_dashboard/css/common.css' %}" rel="stylesheet">
<link href="{% static 'teachers/css/main_home.css' %}" rel="stylesheet">



  <!------------------- Custom Common Css End -------------------->



<link rel="stylesheet" href="https://unpkg.com/nepali-date-picker@2.0.1/dist/nepaliDatePicker.min.css" crossorigin="anonymous" />

  <title> {% block title %} {% endblock %}</title>
  <!-- <link rel="icon" type="images/jpg" href="">  -->
  <!-- <link rel="icon" type="images/jpg" href="">  -->
  <link rel="icon" type="images/jpg" href="{% static 'image/easy-academy-1.png' %}"> 
  {% block head_css %}
  {% endblock head_css%}
</head>

{% endblock head %}

<body class="hold-transition sidebar-mini layout-fixed">
  <div class="page-loader home-loader">
    <div class="inner-loader">
      <div class="spinner-border text-center" style="width: 3rem; height: 3rem;" role="status">
        <span class="sr-only">Loading...</span>
      </div>
      <div class="spinner-grow text-center" style="width: 3rem; height: 3rem;" role="status">
        <span class="sr-only">Loading...</span>
      </div>
      <div class="loader__figure" />
    </div>
  </div>
</div>

  <div class="wrapper">

    <!-- Navbar -->
    {% comment %} <nav class="main-header navbar navbar-expand navbar-white navbar-light">
      <!-- Left navbar links -->
      <ul class="navbar-nav">
        <li class="nav-item">
          <a class="nav-link" data-widget="pushmenu" href="#"><i class="fas fa-bars" style="background-color: black;"></i></a>
        </li>
      </ul>
      <h5 style="margin-left: 10px;margin-top: 5px;">SCHOOL MIS</h5> {% endcomment %}

 <!----------------------------------------------------------------- Right navbar links --------------------------------------------------->
                            {% comment %} {% include "includes/right_navbar.html" %} {% endcomment %}
 <!----------------------------------------------------------------- Right navbar links --------------------------------------------------->
 {% comment %} {% include "includes/include_admin/erp_components.html" %}
 {% include "includes/include_admin/classroom_popup.html" %} {% endcomment %}

    <!-- Main Sidebar Container -->
    {% comment %} {% include 'includes/include_admin/admin_sidebar.html'%} {% endcomment %}

    <!-- Content Wrapper. Contains page content -->
    <div class="content-wrapper" style="margin-left:0px;">
      <!-- Content Header (Page header) -->
      <div class="content-header">
        <div class="container-fluid">
          <div class="row">
            <div class="col-sm-6">
              <h2 class="m-0 text-dark">
                <!-- {% block page_title %}{% endblock page_title %} -->
              </h2>

            </div>

            <div class="col-sm-6">
              <ol class="breadcrumb float-sm-right">
                <!-- <li class="breadcrumb-item"><a href="/admin_content/">Home</a></li> -->
              </ol>
            </div>

            <!-- /.col -->
          </div><!-- /.row -->
        </div><!-- /.container-fluid -->
      </div>
      <!-- /.content-header -->

      {% block main_content %}{% endblock main_content %}
      {% block content %}{% endblock content %}
    </div>


    <!-- /.content-wrapper -->

  </div>

  <!-- ./wrapper -->
  {% comment %} <div class="row no-print">
    <footer class="main-footer">

    <div class="row">
      <div class="col-md-12">
        <strong>Copyright &copy; {% now 'Y' %} <a href=""></a>.</strong> All rights
        reserved.
      </div>
     
    </div>
  
     
    </footer>
    <div class="mt-4" style="margin-left: 55%;">
      <b>Version</b> {{setting_instance.version}}
    </div>
   
  </div> {% endcomment %}


  <!----------For AdminLTE bootstrap js link--------------->
  {% include "includes/adminlte_jquery.html" %}
  <!--------------for datatables---------------------->
  <!--for datatables csv pdf -- code --------------->
  {% include "includes/datatables_js.html" %}

  

  {% block custom_css %}{% endblock custom_css %}
  {% block custom_js %}{% endblock custom_js %}
  {% block javascript %}{% endblock %}
  <div id="confirm-modal" class="modal fade">
    <div class="modal-dialog modal-confirm">
      <div class="modal-content">
        <div class="modal-header flex-column">
          <div class="icon-box"></div>
          <h4 class="modal-title text-center w-100">Are you sure?</h4>
          <button
            type="button"
            class="close"
            data-dismiss="modal"
            aria-hidden="true"
          >
            &times;
          </button>
        </div>
        <div class="modal-body text-center">
          <p class="confirm-message"></p>
        </div>
        <div class="modal-footer justify-content-center"></div>
      </div>
    </div>
  </div>
</body>

<script
type="text/javascript"
src="{% static 'flipbook/pdfjs-flipbook/js/jquery.fancybox.min.js' %}"
></script>
  <!-- flipbook js -->
  <link
  rel="stylesheet"
  type="text/css"
  href="{% static 'flipbook/pdfjs-flipbook/css/jquery.fancybox.min.css' %}"
/>

<script src="{% static 'plugins/toastr/toastr.min.js' %}"></script>
<script src="{% static 'plugins/select2/js/select2.min.js' %}"></script>
<!-- <script src="{% static 'plugins/jquery-ui/jquery-ui.min.js' %}"></script> -->

<script src="{% static 'plugins/overlayScrollbars/js/jquery.overlayScrollbars.min.js' %}"></script>
<script src="{% static 'plugins/jquery-mousewheel/jquery.mousewheel.js' %}"></script>
<script src="{% static 'plugins/raphael/raphael.min.js' %}"></script>
<script src="{% static 'plugins/jquery-mapael/jquery.mapael.min.js' %}"></script>
{% comment %} Nepali date picker {% endcomment %}
<script src="https://unpkg.com/nepali-date-picker@2.0.1/dist/jquery.nepaliDatePicker.min.js" crossorigin="anonymous"></script>

<script>
  
  $(".date-picker").nepaliDatePicker({
    dateFormat: "%y-%m-%d",
    closeOnDateSelect: true
});

function eventLog(event){
    var datePickerData = event.datePickerData;
    var outputData = {
        "type": event.type,
        "message": event.message,
        "datePickerData": datePickerData
    };

    var output = '<p><code>▸ ' + JSON.stringify(outputData) + '</code></p>';
    $('.output').append(output);
}

$(".date-picker").on("show", function (event) {
    var output = '<p><code>▸ Show event trigger</code></p>';
    $('.output').append(output);
});

$(".date-picker").on("yearChange", function (event) {
    eventLog(event);
});

$(".date-picker").on("monthChange", function (event) {
    eventLog(event);
});

$(".date-picker").on("dateChange", function (event) {
    eventLog(event);
});

$(".date-picker").on("dateSelect", function (event) {
    eventLog(event);
});


/*
    $(function(){
      $('.select').select2({theme: 'bootstrap4'});
      $('.selectmultiple').select2({theme: 'bootstrap4'});
  });
*/
  
  $(document).ready(function() {
 
    $('#notification').on("click",function(){
      $("#notification_count").hide();
      console.log('clicked');
      $.ajax({
              type: "GET",
              url: "{% url 'notifications:update_notification' %}",
              dataType: 'json',
              success: function(response){
                console.log(response)
                $("#notification_count").html("");
              },error:function(response){
                  return false;
              }
          });
  });   
  });

  

</script>

<script>
  function Confirmation(message='',callback,confirm_action='delete'){
    $('#confirm-modal').modal('toggle');
    $('#confirm-modal').find('.confirm-message').html(message);
    if(confirm_action =='delete' || confirm_action =='temp_delete'){
      $('#confirm-modal').find('.modal-footer').html(`<button id="confirm-yes" class="btn btn-danger">Delete</button>
      <button type="button" id="confirm-no" class="btn btn-secondary" data-dismiss="modal">
          Cancel
        </button>`);
      $('#confirm-modal').find('.icon-box').html('<i class="fas fa-times"></i>');
    }else{
      $('#confirm-modal').find('.modal-footer').html(`<button id="confirm-yes" class="btn btn-success">Yes</button>
      <button type="button" id="confirm-no" class="btn btn-secondary" data-dismiss="modal">
          No
        </button>`);
        $('#confirm-modal').find('.icon-box').html('<i class="fas fa-check"></i>');
    }
    let confirm_btn = document.getElementById('confirm-yes');
    confirm_btn.onclick = function(){callback(true);$('#confirm-modal').modal('toggle');}

}

function deleteSelected({table,id,message_title, model,app_name,replace_app_name,action='delete'}={}) {
    let ids = $.map(table.rows(".selected").data(), function (item) {
      return item[id];
    });
    if (action == 'delete'){

      message = "Do you really want to delete these record? This process cannot be undone.";
    }else{
      message = "Do you really want to restore these record? This process cannot be undone.";
    }
    if (ids.length > 0) {
      Confirmation(
        message,
        function (response) {
          if (response) {
            $.ajax({
              type: "POST",
              headers: { "X-CSRFToken": "{{csrf_token}}" },
              url: "{% url 'mass_delete' app='app_name' model='Model' %}".replace( "Model",model).replace('app_name',replace_app_name),
              data: {
                ids: ids,
                action:action
              },
              success: function () {
                table.ajax.reload();
                toastr.success(
                  `${message_title} data were sucessfully deleted`
                );
              },
            });
          }
        },action
      );
    } else {
      toastr.error("No row selected", "Error");
    }
  }

  
 $("#checkBox").on("click", function () {
          table_id = $(this).parents('table').attr('id');
          table = $('#'+table_id).DataTable();
            if ($("#checkBox").is(":checked")) {
              table.rows().select();
            } else {
              table.rows().deselect();
            }
          });

    $(function(){



        $(document).on('click','.btn-delete',function(event){
            let url = $(this).attr('href');
            let form = $(this).parents('form');
            event.preventDefault();
            Confirmation(
              "Do you really want to delete these record? This process cannot be undone.",
              function (response) {
                if (response) {
                  form.trigger('submit');
                }
              });
        });

        $(document).on('click','.btn-trash',function(event){

            let url = $(this).attr('href');
            event.preventDefault();
            Confirmation(
              "Do you really want to delete these record? This process cannot be undone.",
              function (response) {
                if (response) {
                  window.location.replace(url);
                }
              });
        });

        $(document).on('click','.btn-restore',function(event){
            let url = $(this).attr('href');
            let form = $(this).parents('form');
            event.preventDefault();
            Confirmation(
              "Do you really want to restore these record?",
              function (response) {
                if (response) {
                  form.trigger('submit');
                }
              },'restore');
        });

        $('form').submit(function(e){
            $(this).find(':submit').prop('disabled',true);
        });

        // $('.dataTable').dataTable();


       

      });
    
        $(document).ready(function(){
          $('.page-loader').hide();
        });


{% comment %} for course select field  {% endcomment %}




$("#id_course").change(function(){
  var course_id = $(this).val();
  
  
  $.ajax({
      url:" {% url 'attendance_app:fill_semester_from_course' %}",
      data:{'course':course_id},
      success:function(data){
          $("#id_semester").html(data);
      }
  })
})
$("#id_filter_course").change(function(){
  var course_id = $(this).val();
  
  
  $.ajax({
      url:" {% url 'attendance_app:fill_semester_from_course' %}",
      data:{'course':course_id},
      success:function(data){
          $("#id_filter_semester").html(data);
      }
  })
})
$("#div_id_course_category input:radio").change(function(){
  var course_category_id = $(this).val();
  if(course_category_id == 1){
    $.ajax({
      url:" {% url 'attendance_app:fill_course_select' %}",
      data:{'course_category':course_category_id},
      success:function(data){
          $("#id_semester").html(data);
          $("#id_course").html('');
      }
  })}
  else{
    $.ajax({
      
      url:" {% url 'attendance_app:fill_course_select' %}",
      data:{'course_category':course_category_id},
      success:function(data){
          $("#id_course").html(data);
      }
  })
  }
})

$("#id_course_category").change(function(){
  var course_category_id = $(this).val();
  if(course_category_id == 1){
    $.ajax({
      url:" {% url 'attendance_app:fill_course_select' %}",
      data:{'course_category':course_category_id},
      success:function(data){
        $("#id_filter_semester").html(data);
        $("#id_filter_course").html('');

    }
 

  })
  }
  else{
    $.ajax({
      url:" {% url 'attendance_app:fill_course_select' %}",
      data:{'course_category':course_category_id},
      success:function(data){
        $("#id_filter_course").html(data);
    }
 
     
  })
  }

})

$("#id_semester").change(function(){
  var semester_id = $(this).val();
  
  
  $.ajax({
      url:" {% url 'attendance_app:fill_section_select' %}",
      data:{'semester':semester_id},
      success:function(data){
          $("#id_section").html(data);
      }
  })
})

$("#id_filter_semester").change(function(){
  var semester_id = $(this).val();
  {% comment %} var semester_text = $(this).find(':selected').text(); {% endcomment %}
  
  
  $.ajax({
      url:" {% url 'attendance_app:fill_section_select' %}",
      data:{'semester':semester_id,
      {% comment %} 'semester_text':semester_text {% endcomment %}
    },
      success:function(data){
          $("#id_section").html(data);
      }
  })
})


$("#id_semester").change(function(){
  var semester_id = $(this).val();
 // var course_category_id = $('#id_course_category').val();
  
  
  $.ajax({
      url:" {% url 'attendance_app:fill_subject_select' %}",
      data:{'semester':semester_id,
     // 'course_category':course_category_id
    },
      success:function(data){
          $("#id_subject").html(data);
      }
  })
})

  //get search form based on course category
  
  $('#id_course_category').change(function(){
    var course_category = $('#id_course_category option:selected').text()
    if(course_category ==  'School'){
      $('#id_filter_semester').removeAttr("hidden");
      $('#id_section').removeAttr("hidden");
      $('#id_subject').attr("hidden",true);
    
     }
    if(course_category ==  'Plus-Two'){
     $('#id_filter_semester').removeAttr("hidden");
     $('#id_filter_course').removeAttr("hidden");
     $('#id_section').removeAttr("hidden");
     $('#id_subject').attr("hidden",true);
    }
    if(course_category ==  'Bachelor' || course_category ==  'Master'){
     $('#id_filter_semester').removeAttr("hidden");
     $('#id_subject').removeAttr("hidden");
     $('#id_section').removeAttr("hidden");
     $('#id_filter_course').removeAttr("hidden");
    }
  })
 
    
</script>

{% include "static_includes/fullcalendar_cdn.html" %}

<style>
{% comment %} For inline radion botton {% endcomment %}
 
</style>
 {% if messages %}
 {% for message in messages %}
 <script type=text/javascript>
   toastr.options.progressBar = true;
   toastr.{{ message.tags }}('{{ message }}')
 </script>
 {% endfor %}
 {% endif %}

</html>